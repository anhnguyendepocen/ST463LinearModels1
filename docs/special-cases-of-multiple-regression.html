<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Notes for ST463/ST683 Linear Models 1</title>
  <meta name="description" content="These are the notes for ST463/ST683 Linear Models 1 module at Maynooth University. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Notes for ST463/ST683 Linear Models 1" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the notes for ST463/ST683 Linear Models 1 module at Maynooth University. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="domijank/ST463" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Notes for ST463/ST683 Linear Models 1" />
  
  <meta name="twitter:description" content="These are the notes for ST463/ST683 Linear Models 1 module at Maynooth University. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Katarina Domijan">


<meta name="date" content="2018-11-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="diagnostic-methods-in-more-details.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Module Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#recommended-texts"><i class="fa fa-check"></i><b>1.1</b> Recommended texts</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>1.2</b> Software</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-scripts"><i class="fa fa-check"></i><b>1.3</b> R Scripts</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#introductory-examples"><i class="fa fa-check"></i><b>2.1</b> Introductory Examples</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#mother-and-daughter-heights"><i class="fa fa-check"></i><b>2.1.1</b> Mother and daughter heights</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#bacterial-count-and-storage-temperature"><i class="fa fa-check"></i><b>2.1.2</b> Bacterial count and storage temperature</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#yield-and-rainfall"><i class="fa fa-check"></i><b>2.1.3</b> Yield and Rainfall</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#driving"><i class="fa fa-check"></i><b>2.1.4</b> Driving</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#fuel"><i class="fa fa-check"></i><b>2.1.5</b> Fuel Consumption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SLR.html"><a href="SLR.html"><i class="fa fa-check"></i><b>3</b> Simple Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="SLR.html"><a href="SLR.html#OLS"><i class="fa fa-check"></i><b>3.1</b> Ordinary least squares</a><ul>
<li class="chapter" data-level="3.1.1" data-path="SLR.html"><a href="SLR.html#residuals"><i class="fa fa-check"></i><b>3.1.1</b> Residuals</a></li>
<li class="chapter" data-level="3.1.2" data-path="SLR.html"><a href="SLR.html#some-algebraic-implications-of-the-ols-fit"><i class="fa fa-check"></i><b>3.1.2</b> Some algebraic implications of the OLS fit</a></li>
<li class="chapter" data-level="3.1.3" data-path="SLR.html"><a href="SLR.html#ols-estimates-for-the-fuel-consumption-example"><i class="fa fa-check"></i><b>3.1.3</b> OLS Estimates for the Fuel Consumption Example</a></li>
<li class="chapter" data-level="3.1.4" data-path="SLR.html"><a href="SLR.html#interpretation-of-the-fitted-simple-linear-regression-line-parameter-estimates"><i class="fa fa-check"></i><b>3.1.4</b> Interpretation of the fitted simple linear regression line: Parameter estimates</a></li>
<li class="chapter" data-level="3.1.5" data-path="SLR.html"><a href="SLR.html#predicting"><i class="fa fa-check"></i><b>3.1.5</b> Predicting</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="SLR.html"><a href="SLR.html#the-formal-simple-linear-regression-model"><i class="fa fa-check"></i><b>3.2</b> The formal simple linear regression model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="SLR.html"><a href="SLR.html#model"><i class="fa fa-check"></i><b>3.2.1</b> Model</a></li>
<li class="chapter" data-level="3.2.2" data-path="SLR.html"><a href="SLR.html#assumptions"><i class="fa fa-check"></i><b>3.2.2</b> Assumptions</a></li>
<li class="chapter" data-level="3.2.3" data-path="SLR.html"><a href="SLR.html#estimation-of-sigma2"><i class="fa fa-check"></i><b>3.2.3</b> Estimation of <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="3.2.4" data-path="SLR.html"><a href="SLR.html#review-of-some-probability-results"><i class="fa fa-check"></i><b>3.2.4</b> Review of some probability results</a></li>
<li class="chapter" data-level="3.2.5" data-path="SLR.html"><a href="SLR.html#prop"><i class="fa fa-check"></i><b>3.2.5</b> Properties of the estimates</a></li>
<li class="chapter" data-level="3.2.6" data-path="SLR.html"><a href="SLR.html#special-cases"><i class="fa fa-check"></i><b>3.2.6</b> Special cases</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="SLR.html"><a href="SLR.html#simple-linear-regression-models-in-r-and-minitab"><i class="fa fa-check"></i><b>3.3</b> Simple linear regression models in R and Minitab</a><ul>
<li class="chapter" data-level="3.3.1" data-path="SLR.html"><a href="SLR.html#minitab"><i class="fa fa-check"></i><b>3.3.1</b> Minitab</a></li>
<li class="chapter" data-level="3.3.2" data-path="SLR.html"><a href="SLR.html#r"><i class="fa fa-check"></i><b>3.3.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="SLR.html"><a href="SLR.html#statistical-inference"><i class="fa fa-check"></i><b>3.4</b> Statistical inference</a><ul>
<li class="chapter" data-level="3.4.1" data-path="SLR.html"><a href="SLR.html#r-simulation-paraminference.r"><i class="fa fa-check"></i><b>3.4.1</b> R simulation: ParamInference.R</a></li>
<li class="chapter" data-level="3.4.2" data-path="SLR.html"><a href="SLR.html#inference-for-beta_1"><i class="fa fa-check"></i><b>3.4.2</b> Inference for <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="3.4.3" data-path="SLR.html"><a href="SLR.html#inference-for-beta_0"><i class="fa fa-check"></i><b>3.4.3</b> Inference for <span class="math inline">\(\beta_0\)</span></a></li>
<li class="chapter" data-level="3.4.4" data-path="SLR.html"><a href="SLR.html#inference-for-mean-response"><i class="fa fa-check"></i><b>3.4.4</b> Inference for mean response</a></li>
<li class="chapter" data-level="3.4.5" data-path="SLR.html"><a href="SLR.html#inference-for-prediction"><i class="fa fa-check"></i><b>3.4.5</b> Inference for prediction</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="SLR.html"><a href="SLR.html#analysis-of-variance-for-s.l.r."><i class="fa fa-check"></i><b>3.5</b> Analysis of variance (for s.l.r.)</a><ul>
<li class="chapter" data-level="3.5.1" data-path="SLR.html"><a href="SLR.html#anova-decomposition"><i class="fa fa-check"></i><b>3.5.1</b> ANOVA decomposition</a></li>
<li class="chapter" data-level="3.5.2" data-path="SLR.html"><a href="SLR.html#anova-table"><i class="fa fa-check"></i><b>3.5.2</b> ANOVA table</a></li>
<li class="chapter" data-level="3.5.3" data-path="SLR.html"><a href="SLR.html#special-cases-1"><i class="fa fa-check"></i><b>3.5.3</b> Special cases</a></li>
<li class="chapter" data-level="3.5.4" data-path="SLR.html"><a href="SLR.html#does-regression-on-x-explain-y"><i class="fa fa-check"></i><b>3.5.4</b> Does regression on x explain y?</a></li>
<li class="chapter" data-level="3.5.5" data-path="SLR.html"><a href="SLR.html#notes-on-the-anova-table"><i class="fa fa-check"></i><b>3.5.5</b> Notes on the ANOVA table</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="SLR.html"><a href="SLR.html#sample-correlation"><i class="fa fa-check"></i><b>3.6</b> Sample correlation</a><ul>
<li class="chapter" data-level="3.6.1" data-path="SLR.html"><a href="SLR.html#examples-of-correlation"><i class="fa fa-check"></i><b>3.6.1</b> Examples of correlation</a></li>
<li class="chapter" data-level="3.6.2" data-path="SLR.html"><a href="SLR.html#comparison-of-the-correlation-and-coefficient-of-determination-for-two-data-sets."><i class="fa fa-check"></i><b>3.6.2</b> Comparison of the correlation and coefficient of determination for two data sets.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="SLR.html"><a href="SLR.html#assessing-the-simple-linear-regression-model-assumptions"><i class="fa fa-check"></i><b>3.7</b> Assessing the simple linear regression model assumptions</a><ul>
<li class="chapter" data-level="3.7.1" data-path="SLR.html"><a href="SLR.html#assumptions-1"><i class="fa fa-check"></i><b>3.7.1</b> Assumptions</a></li>
<li class="chapter" data-level="3.7.2" data-path="SLR.html"><a href="SLR.html#violations-and-consequences"><i class="fa fa-check"></i><b>3.7.2</b> Violations and consequences</a></li>
<li class="chapter" data-level="3.7.3" data-path="SLR.html"><a href="SLR.html#graphical-tools-for-assessment"><i class="fa fa-check"></i><b>3.7.3</b> Graphical tools for assessment</a></li>
<li class="chapter" data-level="3.7.4" data-path="SLR.html"><a href="SLR.html#cigarette"><i class="fa fa-check"></i><b>3.7.4</b> Cigarette Data</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="SLR.html"><a href="SLR.html#a-note-on-the-galton-paradox"><i class="fa fa-check"></i><b>3.8</b> A note on the Galton paradox</a><ul>
<li class="chapter" data-level="3.8.1" data-path="SLR.html"><a href="SLR.html#the-galton-paradox"><i class="fa fa-check"></i><b>3.8.1</b> The Galton paradox</a></li>
<li class="chapter" data-level="3.8.2" data-path="SLR.html"><a href="SLR.html#two-regressions"><i class="fa fa-check"></i><b>3.8.2</b> Two regressions</a></li>
<li class="chapter" data-level="3.8.3" data-path="SLR.html"><a href="SLR.html#regression-vs-orthogonal-regression"><i class="fa fa-check"></i><b>3.8.3</b> Regression vs orthogonal regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>4</b> Multiple regression</a><ul>
<li class="chapter" data-level="4.1" data-path="multiple-regression.html"><a href="multiple-regression.html#introductory-examples-1"><i class="fa fa-check"></i><b>4.1</b> Introductory examples</a><ul>
<li class="chapter" data-level="4.1.1" data-path="multiple-regression.html"><a href="multiple-regression.html#example-1-fuel-use"><i class="fa fa-check"></i><b>4.1.1</b> Example 1: Fuel Use</a></li>
<li class="chapter" data-level="4.1.2" data-path="multiple-regression.html"><a href="multiple-regression.html#example-2-categorical-predictors"><i class="fa fa-check"></i><b>4.1.2</b> Example 2: Categorical predictors</a></li>
<li class="chapter" data-level="4.1.3" data-path="multiple-regression.html"><a href="multiple-regression.html#example-3-polynomials"><i class="fa fa-check"></i><b>4.1.3</b> Example 3: Polynomials</a></li>
<li class="chapter" data-level="4.1.4" data-path="multiple-regression.html"><a href="multiple-regression.html#example-4-nonlinear-relationships"><i class="fa fa-check"></i><b>4.1.4</b> Example 4: Nonlinear relationships</a></li>
<li class="chapter" data-level="4.1.5" data-path="multiple-regression.html"><a href="multiple-regression.html#cigarette-data-continued"><i class="fa fa-check"></i><b>4.1.5</b> Cigarette Data continued</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multiple-regression.html"><a href="multiple-regression.html#least-squares-estimation-for-multiple-regression"><i class="fa fa-check"></i><b>4.2</b> Least squares estimation for multiple regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="multiple-regression.html"><a href="multiple-regression.html#estimation-of-sigma2-varepsilon"><i class="fa fa-check"></i><b>4.2.1</b> Estimation of <span class="math inline">\(\sigma^2\)</span> = Var<span class="math inline">\((\epsilon)\)</span></a></li>
<li class="chapter" data-level="4.2.2" data-path="multiple-regression.html"><a href="multiple-regression.html#estimation-of-varhatbeta"><i class="fa fa-check"></i><b>4.2.2</b> Estimation of Var<span class="math inline">\((\hat{\beta})\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multiple-regression.html"><a href="multiple-regression.html#prediction-from-multiple-linear-regression-model"><i class="fa fa-check"></i><b>4.3</b> Prediction from multiple linear regression model</a></li>
<li class="chapter" data-level="4.4" data-path="multiple-regression.html"><a href="multiple-regression.html#regression-models-in-matrix-notation-examples"><i class="fa fa-check"></i><b>4.4</b> Regression models in matrix notation: examples</a><ul>
<li class="chapter" data-level="4.4.1" data-path="multiple-regression.html"><a href="multiple-regression.html#example-1-slr"><i class="fa fa-check"></i><b>4.4.1</b> Example 1: SLR</a></li>
<li class="chapter" data-level="4.4.2" data-path="multiple-regression.html"><a href="multiple-regression.html#example-2"><i class="fa fa-check"></i><b>4.4.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="multiple-regression.html"><a href="multiple-regression.html#the-formal-multiple-regression-model-and-properties"><i class="fa fa-check"></i><b>4.5</b> The formal multiple regression model and properties</a><ul>
<li class="chapter" data-level="4.5.1" data-path="multiple-regression.html"><a href="multiple-regression.html#concepts-random-vectors-covariance-matrix-multivariate-normal-distribution-mvn."><i class="fa fa-check"></i><b>4.5.1</b> Concepts: random vectors, covariance matrix, multivariate normal distribution (MVN).</a></li>
<li class="chapter" data-level="4.5.2" data-path="multiple-regression.html"><a href="multiple-regression.html#multiple-regression-model"><i class="fa fa-check"></i><b>4.5.2</b> Multiple regression model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="multiple-regression.html"><a href="multiple-regression.html#the-hat-matrix"><i class="fa fa-check"></i><b>4.6</b> The hat matrix</a><ul>
<li class="chapter" data-level="4.6.1" data-path="multiple-regression.html"><a href="multiple-regression.html#the-qr-decomposition-of-a-matrix"><i class="fa fa-check"></i><b>4.6.1</b> The QR Decomposition of a matrix</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="multiple-regression.html"><a href="multiple-regression.html#anova-for-multiple-regression"><i class="fa fa-check"></i><b>4.7</b> ANOVA for multiple regression</a></li>
<li class="chapter" data-level="4.8" data-path="multiple-regression.html"><a href="multiple-regression.html#way-anova-model"><i class="fa fa-check"></i><b>4.8</b> 1-way ANOVA model</a><ul>
<li class="chapter" data-level="4.8.1" data-path="multiple-regression.html"><a href="multiple-regression.html#example"><i class="fa fa-check"></i><b>4.8.1</b> Example:</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="multiple-regression.html"><a href="multiple-regression.html#one-way-anova-in-regression-notation"><i class="fa fa-check"></i><b>4.9</b> One way ANOVA in regression notation</a><ul>
<li class="chapter" data-level="4.9.1" data-path="multiple-regression.html"><a href="multiple-regression.html#fitting-the-model-in-mtb-and-r"><i class="fa fa-check"></i><b>4.9.1</b> Fitting the model in MTB and R</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="multiple-regression.html"><a href="multiple-regression.html#confidence-intervals-and-hypothesis-tests-for-linear-combinations-of-boldsymbolbeta"><i class="fa fa-check"></i><b>4.10</b> Confidence intervals and hypothesis tests for linear combinations of <span class="math inline">\(\boldsymbol{\beta}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html"><i class="fa fa-check"></i><b>5</b> Model comparisons and testing for lack of fit</a><ul>
<li class="chapter" data-level="5.1" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#f-tests-for-comparing-two-models"><i class="fa fa-check"></i><b>5.1</b> F-tests for comparing two models</a><ul>
<li class="chapter" data-level="5.1.1" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-1"><i class="fa fa-check"></i><b>5.1.1</b> Example:</a></li>
<li class="chapter" data-level="5.1.2" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#f-test-to-compare-models"><i class="fa fa-check"></i><b>5.1.2</b> F-test to compare models:</a></li>
<li class="chapter" data-level="5.1.3" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-steam-data"><i class="fa fa-check"></i><b>5.1.3</b> Example: Steam data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#sequential-sums-of-squares"><i class="fa fa-check"></i><b>5.2</b> Sequential sums of squares</a><ul>
<li class="chapter" data-level="5.2.1" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-3"><i class="fa fa-check"></i><b>5.2.1</b> Example:</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-steam-data-1"><i class="fa fa-check"></i><b>5.2.2</b> Example: Steam data</a></li>
<li class="chapter" data-level="5.2.3" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-steam-contd-in-mtb"><i class="fa fa-check"></i><b>5.2.3</b> Example: Steam cont’d in MTB</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#testing-for-lack-of-fit"><i class="fa fa-check"></i><b>5.3</b> Testing for lack of fit</a><ul>
<li class="chapter" data-level="5.3.1" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-voltage"><i class="fa fa-check"></i><b>5.3.1</b> Example: Voltage</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#added-variable-plots"><i class="fa fa-check"></i><b>5.4</b> Added variable plots</a><ul>
<li class="chapter" data-level="5.4.1" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-steam-vs.temp-inv-prod"><i class="fa fa-check"></i><b>5.4.1</b> Example: STEAM vs. TEMP, INV, PROD</a></li>
<li class="chapter" data-level="5.4.2" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-added-variable-plot-for-prod."><i class="fa fa-check"></i><b>5.4.2</b> Example: Added variable plot for PROD.</a></li>
<li class="chapter" data-level="5.4.3" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#example-steam-data-contd"><i class="fa fa-check"></i><b>5.4.3</b> Example: Steam data cont’d</a></li>
<li class="chapter" data-level="5.4.4" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#properties-of-avps"><i class="fa fa-check"></i><b>5.4.4</b> Properties of AVPs:</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="model-comparisons-and-testing-for-lack-of-fit.html"><a href="model-comparisons-and-testing-for-lack-of-fit.html#visualising-models-in-hdim-added-variable-plots-for-the-bodyfat-data."><i class="fa fa-check"></i><b>5.5</b> Visualising Models in Hdim: added variable plots for the bodyfat data.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html"><i class="fa fa-check"></i><b>6</b> Diagnostic methods (in more details)</a><ul>
<li class="chapter" data-level="6.1" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#model-assumptions"><i class="fa fa-check"></i><b>6.1</b> Model assumptions</a></li>
<li class="chapter" data-level="6.2" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#residuals-1"><i class="fa fa-check"></i><b>6.2</b> Residuals</a></li>
<li class="chapter" data-level="6.3" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#leverage-values"><i class="fa fa-check"></i><b>6.3</b> Leverage values</a><ul>
<li class="chapter" data-level="6.3.1" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#properties-of-h_ii"><i class="fa fa-check"></i><b>6.3.1</b> Properties of <span class="math inline">\(h_{ii}\)</span>:</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#standardised-residuals"><i class="fa fa-check"></i><b>6.4</b> Standardised residuals</a></li>
<li class="chapter" data-level="6.5" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#leave-one-out-methods"><i class="fa fa-check"></i><b>6.5</b> Leave-one-out methods</a></li>
<li class="chapter" data-level="6.6" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#other-influence-measures"><i class="fa fa-check"></i><b>6.6</b> Other influence measures</a></li>
<li class="chapter" data-level="6.7" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#testing-outliers"><i class="fa fa-check"></i><b>6.7</b> Testing outliers</a></li>
<li class="chapter" data-level="6.8" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#diagnostics-examples-two-case-studies"><i class="fa fa-check"></i><b>6.8</b> Diagnostics examples (two case studies)</a><ul>
<li class="chapter" data-level="6.8.1" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#example-1-brain-size-versus-body-gestation-period-and-litter"><i class="fa fa-check"></i><b>6.8.1</b> Example 1: Brain size versus body gestation period and litter</a></li>
<li class="chapter" data-level="6.8.2" data-path="diagnostic-methods-in-more-details.html"><a href="diagnostic-methods-in-more-details.html#example-2-rat-data"><i class="fa fa-check"></i><b>6.8.2</b> Example 2: Rat data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="special-cases-of-multiple-regression.html"><a href="special-cases-of-multiple-regression.html"><i class="fa fa-check"></i><b>7</b> Special cases of multiple regression</a><ul>
<li class="chapter" data-level="7.1" data-path="special-cases-of-multiple-regression.html"><a href="special-cases-of-multiple-regression.html#categorical-and-continuous-predictors-binary-categories"><i class="fa fa-check"></i><b>7.1</b> Categorical and continuous predictors (binary categories)</a></li>
<li class="chapter" data-level="7.2" data-path="special-cases-of-multiple-regression.html"><a href="special-cases-of-multiple-regression.html#categorical-and-continuous-predictors-more-than-two-categories"><i class="fa fa-check"></i><b>7.2</b> Categorical and continuous predictors (more than two categories)</a></li>
<li class="chapter" data-level="7.3" data-path="special-cases-of-multiple-regression.html"><a href="special-cases-of-multiple-regression.html#quadratic-terms-and-interactions"><i class="fa fa-check"></i><b>7.3</b> Quadratic terms and interactions</a></li>
<li class="chapter" data-level="7.4" data-path="special-cases-of-multiple-regression.html"><a href="special-cases-of-multiple-regression.html#an-example-with-two-continuous-and-two-categorical-predictors"><i class="fa fa-check"></i><b>7.4</b> An example with two continuous and two categorical predictors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for ST463/ST683 Linear Models 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="special-cases-of-multiple-regression" class="section level1">
<h1><span class="header-section-number">7</span> Special cases of multiple regression</h1>
<div id="categorical-and-continuous-predictors-binary-categories" class="section level2">
<h2><span class="header-section-number">7.1</span> Categorical and continuous predictors (binary categories)</h2>
<div id="example-from-ramsey2002statistical-pg-236-245" class="section level4">
<h4><span class="header-section-number">7.1.0.1</span> Example (from <span class="citation">Ramsey and Schafer (<a href="#ref-ramsey2002statistical">2002</a>)</span> pg 236, 245):</h4>
<ul>
<li><p><span class="math inline">\(Y\)</span>: average number of flowers per plant (meadowfoam).</p></li>
<li><p>Light intensity: 150, 300, 450, 600, 750, 900 (<span class="math inline">\(\mu\)</span> mol/<span class="math inline">\(m^2\)</span>/sec)</p></li>
<li><p>Timing: Timing of onset of light treatment Early/Late. Coded 0/1.</p></li>
</ul>
<p>Suppose data is in the table below (every 2nd row) and consider the following models:</p>
<p>Parallel lines model (model A):</p>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1(timing)+ \beta_2 (light)\]</span></p>
<p>Separate lines model (model B):</p>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1(timing)+ \beta_2 (light) + \beta_3 (timing \times light)\]</span></p>
<ul>
<li>Give the design matrix and the parameter vector for both models</li>
<li>Test <span class="math inline">\(H_0: \beta_3 = 0\)</span>.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">Flowers</th>
<th align="left">Timing</th>
<th align="right">Time</th>
<th align="right">Intensity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">62.3</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">77.4</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="right">55.3</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="right">54.2</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">300</td>
</tr>
<tr class="odd">
<td align="right">49.6</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">450</td>
</tr>
<tr class="even">
<td align="right">61.9</td>
<td align="left">Early</td>
<td align="right">0</td>
<td align="right">450</td>
</tr>
</tbody>
</table>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Parallel lines model:</p>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1(timing)+ \beta_2 (light)\]</span></p>
<p><span class="math display">\[\mathbf{X} = \begin{bmatrix}
1 &amp; 0 &amp; 150 \\
1 &amp; 0 &amp; 300\\
1 &amp; 0 &amp; 450 \\
1 &amp; 0 &amp; 600\\
1 &amp; 0 &amp; 750\\
1 &amp; 0 &amp; 900\\
1 &amp; 1 &amp; 150 \\
1 &amp; 1 &amp; 300\\
1 &amp; 1 &amp; 450 \\
1 &amp; 1 &amp; 600 \\
1 &amp; 1 &amp; 750\\
1 &amp; 1 &amp; 900 \\
\end{bmatrix}\]</span></p>
<p><span class="math inline">\(\boldsymbol{\beta} = \begin{bmatrix} \beta_0 \\ \beta_1 \\ \beta_2\\ \end{bmatrix}\)</span></p>
<p>Separate lines model:</p>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1(timing)+ \beta_2 (light) + \beta_3 (timing \times light)\]</span></p>
<p><span class="math display">\[\mathbf{X} = \begin{bmatrix}
1 &amp; 0 &amp; 150 &amp;0 \\
1 &amp; 0 &amp; 300 &amp;0 \\
1 &amp; 0 &amp; 450 &amp;0 \\
1 &amp; 0 &amp; 600 &amp;0 \\
1 &amp; 0 &amp; 750 &amp;0 \\
1 &amp; 0 &amp; 900 &amp;0 \\
1 &amp; 1 &amp; 150 &amp;150 \\
1 &amp; 1 &amp; 300 &amp;300 \\
1 &amp; 1 &amp; 450 &amp;450 \\
1 &amp; 1 &amp; 600 &amp;600 \\
1 &amp; 1 &amp; 750 &amp;750 \\
1 &amp; 1 &amp; 900 &amp;900 \\
\end{bmatrix}\]</span></p>
<p><span class="math display">\[\boldsymbol{\beta} = \begin{bmatrix}
\beta_0 \\
\beta_1 \\
\beta_2\\
\beta_3\\
\end{bmatrix}\]</span></p>
<p>To test <span class="math inline">\(H_0: \beta_3 = 0\)</span>, P-value = 0.910, so cannot reject <span class="math inline">\(H_0\)</span> (See table of coefficients, output below).</p>
<p>Model A</p>
<pre><code>
  Regression Analysis: Flowers versus Time, Intensity
  
  Analysis of Variance
  
  Source         DF  Seq SS   Seq MS  F-Value  P-Value
  Regression      2  3466.7  1733.35    41.78    0.000
  Time            1   887.0   886.95    21.38    0.000
  Intensity       1  2579.8  2579.75    62.18    0.000
  Error          21   871.2    41.49
  Lack-of-Fit     9   215.3    23.92     0.44    0.889
  Pure Error     12   655.9    54.66
  Total          23  4337.9
  
  
  Model Summary
  
  S        R-sq       R-sq(adj)   R-sq(pred)
  6.44107  79.92%     78.00%      73.84%
  
  
  Coefficients
  
  Term           Coef  SE Coef  T-Value  P-Value   VIF
  Constant      71.31     3.27    21.78    0.000
  Time          12.16     2.63     4.62    0.000  1.00
  Intensity  -0.04047  0.00513    -7.89    0.000  1.00
  
  
  Regression Equation
  
  Flowers = 71.31 + 12.16 Time - 0.04047 Intensity
  
  </code></pre>
<p>Model B</p>
<pre><code>  Regression Analysis: Flowers versus Time, Intensity, TxI
  
  Analysis of Variance
  
  Source         DF   Seq SS   Seq MS  F-Value  P-Value
  Regression      3  3467.28  1155.76    26.55    0.000
  Time            1   886.95   886.95    20.37    0.000
  Intensity       1  2579.75  2579.75    59.26    0.000
  TxI             1     0.58     0.58     0.01    0.910
  Error          20   870.66    43.53
  Lack-of-Fit     8   214.73    26.84     0.49    0.841
  Pure Error     12   655.93    54.66
  Total          23  4337.94
  
  
  Model Summary
  
  S        R-sq       R-sq(adj)   R-sq(pred)
  6.59795  79.93%     76.92%      70.95%
  
  
  Coefficients
  
  Term           Coef  SE Coef  T-Value  P-Value   VIF
  Constant      71.62     4.34    16.49    0.000
  Time          11.52     6.14     1.88    0.075  5.20
  Intensity  -0.04108  0.00744    -5.52    0.000  2.00
  TxI          0.0012   0.0105     0.12    0.910  6.20
  
  
  Regression Equation
  
  Flowers = 71.62 + 11.52 Time - 0.04108 Intensity + 0.0012 TxI
  
  </code></pre>
<p>Model A:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Flowers <span class="op">~</span><span class="st"> </span>Intensity <span class="op">+</span><span class="st"> </span>Time)
<span class="kw">summary</span>(fit1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Flowers ~ Intensity + Time)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.652 -4.139 -1.558  5.632 12.165 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 71.305833   3.273772  21.781 6.77e-16 ***
## Intensity   -0.040471   0.005132  -7.886 1.04e-07 ***
## Time        12.158333   2.629557   4.624 0.000146 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.441 on 21 degrees of freedom
## Multiple R-squared:  0.7992, Adjusted R-squared:   0.78 
## F-statistic: 41.78 on 2 and 21 DF,  p-value: 4.786e-08</code></pre>
<p>Model B:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Flowers <span class="op">~</span><span class="st"> </span>Intensity <span class="op">*</span><span class="st"> </span>Time)
<span class="kw">summary</span>(fit2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Flowers ~ Intensity * Time)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.516 -4.276 -1.422  5.473 11.938 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    71.623333   4.343305  16.491 4.14e-13 ***
## Intensity      -0.041076   0.007435  -5.525 2.08e-05 ***
## Time           11.523333   6.142360   1.876   0.0753 .  
## Intensity:Time  0.001210   0.010515   0.115   0.9096    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.598 on 20 degrees of freedom
## Multiple R-squared:  0.7993, Adjusted R-squared:  0.7692 
## F-statistic: 26.55 on 3 and 20 DF,  p-value: 3.549e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">model.matrix</span>(fit2)</code></pre></div>
<pre><code>##    (Intercept) Intensity Time Intensity:Time
## 1            1       150    0              0
## 2            1       150    0              0
## 3            1       300    0              0
## 4            1       300    0              0
## 5            1       450    0              0
## 6            1       450    0              0
## 7            1       600    0              0
## 8            1       600    0              0
## 9            1       750    0              0
## 10           1       750    0              0
## 11           1       900    0              0
## 12           1       900    0              0
## 13           1       150    1            150
## 14           1       150    1            150
## 15           1       300    1            300
## 16           1       300    1            300
## 17           1       450    1            450
## 18           1       450    1            450
## 19           1       600    1            600
## 20           1       600    1            600
## 21           1       750    1            750
## 22           1       750    1            750
## 23           1       900    1            900
## 24           1       900    1            900
## attr(,&quot;assign&quot;)
## [1] 0 1 2 3</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-114-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="categorical-and-continuous-predictors-more-than-two-categories" class="section level2">
<h2><span class="header-section-number">7.2</span> Categorical and continuous predictors (more than two categories)</h2>
<div id="example-from-ramsey2002statistical" class="section level4">
<h4><span class="header-section-number">7.2.0.1</span> Example: (from <span class="citation">Ramsey and Schafer (<a href="#ref-ramsey2002statistical">2002</a>)</span>):</h4>
<ul>
<li><p><span class="math inline">\(Y\)</span>: Measure of energy</p></li>
<li><p><span class="math inline">\(X_1\)</span>: Measure of weight</p></li>
<li><p>Group: Type of flyer (1,2,3). Z1, Z2, Z3 (dummy variables).</p></li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-115-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Parallel lines model (model A):</p>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1 z_2+ \beta_2 z_3 + \beta_3 x_1\]</span></p>
<p>Separate lines model (model B): <span class="math display">\[\mathbb{E}(y)= \beta_0+\beta_1 z_2+ \beta_2 z_3 + \beta_3 x_1 + \beta_4 x_1 z_2+ \beta_5 x_1 z_3\]</span></p>
<p>Hypothesis testing:</p>
<ul>
<li>Test <span class="math inline">\(H_0: \beta_4 = \beta_5 = 0\)</span> by comparing the two models using an F-test.</li>
<li>Test <span class="math inline">\(H_0: \beta_1 = \beta_2 = 0\)</span> by comparing the parallel lines model to the model <span class="math inline">\(\mathbb{E}(y)= \beta_0+\beta_3 x_1\)</span> using an F-test.</li>
<li><p>Give the design matrix and the parameter vector for both models.</p></li>
<li><p>Test <span class="math inline">\(H_0: \beta_4 = \beta_5 = 0\)</span>, i.e.</p></li>
</ul>
<p><span class="math inline">\(H_0:\)</span> Model A is correct</p>
<p><span class="math inline">\(H_A:\)</span> Model B is preferable to Model A</p>
<span class="math display">\[\begin{align*}
F &amp; =\frac{(\mbox{SSE}(A)-\mbox{SSE}(B))/(k-q)}{\mbox{SSE}(B)/(n-p)}\\
&amp; =\frac{(0.5533- 0.5049)/(5-3)}{0.5049/(20-6)}\\
&amp; =\frac{0.0242}{0.0361}\\
&amp; = 0.67.\\
\end{align*}\]</span>
<p><span class="math inline">\(F_{(2,14)}(0.95) = 3.73 &gt; 0.67\)</span> so we cannot reject <span class="math inline">\(H_0\)</span>, model A is OK.</p>
<ul>
<li>Test <span class="math inline">\(H_0: \beta_1 = \beta_2 = 0\)</span>, i.e. let model C = one group model:</li>
</ul>
<p><span class="math display">\[\mathbb{E}(y)= \beta_0+ \beta_3 x_1 \]</span></p>
<p><span class="math inline">\(H_0:\)</span> Model C is correct</p>
<p><span class="math inline">\(H_A:\)</span> Model A is preferable to Model C</p>
<span class="math display">\[\begin{align*}
F &amp; =\frac{(\mbox{SSE}(C)-\mbox{SSE}(A))/(k-q)}{\mbox{SSE}(A)/(n-p)}\\
&amp; =\frac{\mbox{SSR}(A|C)/(3-1)}{0.5533/(20-4)}\\
&amp; =\frac{(0.0008+0.0288)/(3-1)}{0.5533/(20-4)}\\
&amp; =\frac{0.0296/2}{0.0346}\\
&amp; = 0.43\\
\end{align*}\]</span>
<p>We don’t need to see the fit for Model C, take Seq SS.</p>
<p><span class="math inline">\(F_{(2,16)}(0.95) = 3.63 &gt; 0.43\)</span> so we cannot reject <span class="math inline">\(H_0\)</span>, model C is adequate.</p>
<p>OUTPUT: Model A</p>
<pre><code>


Regression Analysis: y versus x1, Z2, Z3

Analysis of Variance

Source      DF   Seq SS   Seq MS  F-Value  P-Value
Regression   3  29.4215   9.8072   283.59    0.000
x1           1  29.3919  29.3919   849.91    0.000
Z2           1   0.0288   0.0288     0.83    0.375
Z3           1   0.0008   0.0008     0.02    0.883
Error       16   0.5533   0.0346
Total       19  29.9748


Model Summary

S         R-sq       R-sq(adj)   R-sq(pred)
0.185963  98.15%     97.81%      97.30%


Coefficients

Term        Coef  SE Coef  T-Value  P-Value   VIF
Constant  -1.498    0.150    -9.99    0.000
x1        0.8150   0.0445    18.30    0.000  2.58
Z2        -0.079    0.203    -0.39    0.703  3.80
Z3         0.024    0.158     0.15    0.883  3.45


Regression Equation

y = -1.498 +0.8150x1 -0.079Z2 +0.024Z3
</code></pre>
<p>OUTPUT: Model B</p>
<pre><code>
Regression Analysis: y versus x1, Z2, Z3, Z2*x1, Z3*x1

Analysis of Variance

Source      DF   Seq SS   Seq MS  F-Value  P-Value
Regression   5  29.4699   5.8940   163.44    0.000
x1           1  29.3919  29.3919   815.04    0.000
Z2           1   0.0288   0.0288     0.80    0.387
Z3           1   0.0008   0.0008     0.02    0.886
Z2*x1        1   0.0452   0.0452     1.25    0.282
Z3*x1        1   0.0032   0.0032     0.09    0.770
Error       14   0.5049   0.0361
Total       19  29.9748


Model Summary

S         R-sq       R-sq(adj)     R-sq(pred)
0.189900  98.32%     97.71%      96.29%


Coefficients

Term        Coef  SE Coef  T-Value  P-Value     VIF
Constant  -1.471    0.248    -5.94    0.000
x1        0.8047   0.0867     9.28    0.000    9.37
Z2          1.27     1.29     0.99    0.341  146.62
Z3        -0.110    0.385    -0.29    0.779   19.70
Z2*x1     -0.215    0.224    -0.96    0.353  166.38
Z3*x1      0.031    0.103     0.30    0.770   41.94


Regression Equation

y = -1.471 +0.8047 x1 +1.27 Z2 -0.110 Z3-
- 0.215Z2 x1 +0.031Z3 x1
</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1G &lt;-<span class="st"> </span>flying.data<span class="op">$</span>x1 <span class="op">*</span><span class="st"> </span>flying.data<span class="op">$</span>G1
x2G &lt;-<span class="st"> </span>flying.data<span class="op">$</span>x1 <span class="op">*</span><span class="st"> </span>flying.data<span class="op">$</span>G2
fitA &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>G1 <span class="op">+</span><span class="st"> </span>G2, <span class="dt">data =</span> flying.data)
<span class="kw">summary</span>(fitA)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + G1 + G2, data = flying.data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.23224 -0.12199 -0.03637  0.12574  0.34457 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.49770    0.14987  -9.993 2.77e-08 ***
## x1           0.81496    0.04454  18.297 3.76e-12 ***
## G1          -0.07866    0.20268  -0.388    0.703    
## G2           0.02360    0.15760   0.150    0.883    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.186 on 16 degrees of freedom
## Multiple R-squared:  0.9815, Adjusted R-squared:  0.9781 
## F-statistic: 283.6 on 3 and 16 DF,  p-value: 4.464e-14</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fitA)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## x1         1 29.3919 29.3919 849.9108 2.691e-15 ***
## G1         1  0.0288  0.0288   0.8327    0.3750    
## G2         1  0.0008  0.0008   0.0224    0.8828    
## Residuals 16  0.5533  0.0346                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitB &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>G1 <span class="op">+</span><span class="st"> </span>G2 <span class="op">+</span><span class="st"> </span>x1G <span class="op">+</span><span class="st"> </span>x2G, <span class="dt">data =</span> flying.data)
<span class="kw">summary</span>(fitB)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + G1 + G2 + x1G + x2G, data = flying.data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.25152 -0.12643 -0.00954  0.08124  0.32840 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.47052    0.24767  -5.937 3.63e-05 ***
## x1           0.80466    0.08668   9.283 2.33e-07 ***
## G1           1.26807    1.28542   0.987    0.341    
## G2          -0.11032    0.38474  -0.287    0.779    
## x1G         -0.21487    0.22362  -0.961    0.353    
## x2G          0.03071    0.10283   0.299    0.770    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1899 on 14 degrees of freedom
## Multiple R-squared:  0.9832, Adjusted R-squared:  0.9771 
## F-statistic: 163.4 on 5 and 14 DF,  p-value: 6.696e-12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fitB)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##           Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
## x1         1 29.3919 29.3919 815.0383 8.265e-14 ***
## G1         1  0.0288  0.0288   0.7986    0.3866    
## G2         1  0.0008  0.0008   0.0215    0.8855    
## x1G        1  0.0452  0.0452   1.2543    0.2816    
## x2G        1  0.0032  0.0032   0.0892    0.7696    
## Residuals 14  0.5049  0.0361                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(fitA, fitB)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ x1 + G1 + G2
## Model 2: y ~ x1 + G1 + G2 + x1G + x2G
##   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)
## 1     16 0.55332                           
## 2     14 0.50487  2   0.04845 0.6718 0.5265</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitC &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1, <span class="dt">data =</span> flying.data)
<span class="co">#summary(fitC)</span>
<span class="co">#anova(fitC)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-117-1.png" width="336" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-117-2.png" width="336" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-117-3.png" width="336" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="quadratic-terms-and-interactions" class="section level2">
<h2><span class="header-section-number">7.3</span> Quadratic terms and interactions</h2>
<p>Example from <span class="citation">Ramsey and Schafer (<a href="#ref-ramsey2002statistical">2002</a>)</span> pg 252. The data on corn yields and rainfall are in `RainfallData.csv’, or library(Sleuth3) in ‘ex0915’. Variables:</p>
<ul>
<li>Yield: corn yield (bushels/acre)</li>
<li>Rainfall: rainfall (inches/year)</li>
<li>Year: year.</li>
</ul>
<p>Link: <a href="http://www.rpubs.com/kdomijan/332466" class="uri">http://www.rpubs.com/kdomijan/332466</a></p>
</div>
<div id="an-example-with-two-continuous-and-two-categorical-predictors" class="section level2">
<h2><span class="header-section-number">7.4</span> An example with two continuous and two categorical predictors</h2>
<p>FEV data - for a full description see <a href="http://ww2.amstat.org/publications/jse/v13n2/datasets.kahn.html" class="uri">http://ww2.amstat.org/publications/jse/v13n2/datasets.kahn.html</a>.</p>
<p>Response variable: fev (forced expiratory volume) measures respiratory function.</p>
<p>Predictors: age, height, gender and smoke.</p>
<p>The dataset is in <code>library(covreg)</code>.</p>
<p>Link: <a href="http://www.rpubs.com/kdomijan/325930" class="uri">http://www.rpubs.com/kdomijan/325930</a></p>
<!-- * Plot corn $yield$ vs $rainfall$. -->
<!-- Fit the multiple regression of corn $yield$ on $rainfall$ and $rainfall^2$. -->
<!-- Save the residuals. -->
<!-- ```{r fig.width=3.5,fig.height=3.5, results='hide',echo=FALSE, fig.align='center'} -->
<!-- rainfall.data <- read.csv("data/RainfallData.csv") -->
<!-- attach(rainfall.data) -->
<!-- plot(RAINFALL, YIELD) -->
<!-- fit1 <- lm(YIELD~RAINFALL + I(RAINFALL^2), -->
<!--            data = rainfall.data) -->
<!-- res.fit1 <- as.numeric(residuals(fit1)) -->
<!-- ``` -->
<!-- Asses the model fit with diagnostic plots. -->
<!-- ```{r fig.width=5.5,fig.height=3.5, results='hide',echo=FALSE, fig.align='center'} -->
<!-- op <- par(mfrow = c(1, 2) ) -->
<!-- plot(fit1, which = c(1, 2)) -->
<!-- par(op) -->
<!-- ``` -->
<!-- * Plot the above residuals vs year. Is there any pattern evident in this plot? What does it mean (hint: advances in technology)? % AVP YEAR - no reln with rain, so not needed. -->
<!-- ```{r fig.width=3.5,fig.height=3.5, results='hide',echo=FALSE, fig.align='center'} -->
<!-- plot(YEAR,res.fit1) -->
<!-- ``` -->
<!-- * Fit the multiple regression of corn $yield$ on $rainfall$, $rainfall^2$ and $year$. How do the coefficients of  $rainfall$, $rainfall^2$ differ from those estimated in model in (a)? How does the estimate of $\sigma$ differ? What about the standard errors of the coefficients? -->
<!-- ```{r , fig.align='center'} -->
<!-- fit2 <- lm(YIELD~RAINFALL + I(RAINFALL^2) + YEAR, -->
<!--            data = rainfall.data) -->
<!-- summary(fit1) -->
<!-- summary(fit2) -->
<!-- ``` -->
<!-- * What is the effect of an increase of one inch of rainfall on the mean yield over the range of rainfalls and years? -->
<!-- * Plot a 3D plot  of $yield$ on $rainfall$, $year$. How would you describe the effect of the two predictors on the response? -->
<!-- ```{r echo=FALSE,rgl=TRUE,fig.height=8,dpi=300,dev='png',results='hide', fig.align='center'} -->
<!-- xRain <- seq(min(RAINFALL),max(RAINFALL), by = 0.1) -->
<!-- xYear <- seq(min(YEAR), max(YEAR), length.out= length(xRain)) -->
<!-- f <- function(x,x2) {r <- coef(fit2)[1] + coef(fit2)[2] * x + -->
<!--   coef(fit2)[3] * x^2 + coef(fit2)[4] * x2} -->
<!-- z <- outer(xRain, xYear, f) -->
<!-- # persp3d(xRain, xYear, z,  col = "light blue", -->
<!-- #         xlab = "Rain", ylab = "Year", zlab = "Yield") -->
<!-- # points3d(RAINFALL, YEAR, YIELD, col="red") -->
<!-- ``` -->
<!-- * Construct an AVP for the interaction term $rainfall \times year$. What does this tell you about the effect of the two predictors on the response? -->
<!-- ```{r fig.width=3.5,fig.height=3.5, fig.align='center'} -->
<!-- rainbyyear <- RAINFALL * YEAR -->
<!-- e2 <- residuals(lm(YIELD~RAINFALL + I(RAINFALL^2) + YEAR, -->
<!--                    data = rainfall.data)) -->
<!-- e1 <- residuals(lm(rainbyyear~RAINFALL + I(RAINFALL^2) + YEAR, -->
<!--                    data = rainfall.data)) -->
<!-- plot(e1, e2) -->
<!-- abline(lm(e2~e1), col = 2) -->
<!-- ``` -->
<!-- * Fit the multiple regression of corn $yield$ on $rainfall$, $rainfall^2$, $year$ and $rainfall \times year$. Is the coefficient of the interaction term significantly different from 0? Could this term be used to say something about the technological improvements regarding irrigation? -->
<!-- ```{r , fig.align='center'} -->
<!-- fit3 <- lm(YIELD~RAINFALL* YEAR + I(RAINFALL^2), -->
<!--            data = rainfall.data) -->
<!-- summary(fit3) -->
<!-- ``` -->
<!-- %```{r fig.width=3.5,fig.height=3.5, results='hide',echo=FALSE, fig.align='center'} -->
<!-- %  -->
<!-- %  -->
<!-- %  -->
<!-- %  -->
<!-- % f <- function(x,x2) {r <- coef(fit3)[1] + coef(fit3)[2] * x + coef(fit3)[3] * x2 + coef(fit3)[4] * x^2 + coef(fit3)[5] * x * x2} -->
<!-- % z <- outer(xRain, xYear, f) -->
<!-- %  -->
<!-- % persp3d(xRain, xYear, z,  col = "light blue", xlab = "Rain", ylab = "Year", zlab = "Yield") -->
<!-- % points3d(RAINFALL, YEAR, YIELD, col="red") -->
<!-- %  -->
<!-- % library(condvis) -->
<!-- %  -->
<!-- % models <- list(fit2, fit3) -->
<!-- % ceplot(data = rainfall.data, model = models, sectionvars = "RAINFALL", threshold = 0.5) -->
<!-- %  -->
<!-- % fit4 <- lm(YIELD~RAINFALL* YEAR, data = rainfall.data) -->
<!-- % #f <- function(x,x2) {r <- coef(fit4)[1] + coef(fit4)[2] * x + coef(fit4)[3] * x2 + coef(fit4)[4] * x * x2} -->
<!-- %  -->
<!-- % f <- function(x,x2) {r <- predict(fit4, newdata =data.frame( cbind(YEAR = x2,RAINFALL = x)))} -->
<!-- % z <- outer(xRain, xYear, f) -->
<!-- %  -->
<!-- % persp3d(xRain, xYear, z,  col = "light blue", xlab = "Rain", ylab = "Year", zlab = "Yield") -->
<!-- % points3d(RAINFALL, YEAR, YIELD, col="red") -->
<!-- %  -->
<!-- % models <- list(fit2, fit3, fit4) -->
<!-- % ceplot(data = rainfall.data, model = models, sectionvars = "RAINFALL", threshold = 0.5) -->
<!-- %  -->
<!-- % fit5 <- lm(YIELD~RAINFALL* YEAR + I(RAINFALL^2) + I(RAINFALL^3), data = rainfall.data) -->
<!-- % summary(fit5) -->
<!-- %  -->
<!-- % library(splines) -->
<!-- % fit5 <- lm(YIELD~RAINFALL* YEAR +bs(RAINFALL), data = rainfall.data) -->
<!-- % summary(fit5) -->
<!-- % f <- function(x,x2) {r <- predict(fit5, newdata =data.frame( cbind(YEAR = x2,RAINFALL = x)))} -->
<!-- %  -->
<!-- %  -->
<!-- %  -->
<!-- % z <- outer(xRain, xYear, f) -->
<!-- %  -->
<!-- % persp3d(xRain, xYear, z,  col = "light blue", xlab = "Rain", ylab = "Year", zlab = "Yield") -->
<!-- % points3d(RAINFALL, YEAR, YIELD, col="red") -->
<!-- %  -->
<!-- %  -->
<!-- % fit6 <- lm(YIELD~bs(RAINFALL) + YEAR, data = rainfall.data) -->
<!-- % summary(fit5) -->
<!-- % f <- function(x,x2) {r <- predict(fit6, newdata =data.frame( cbind(YEAR = x2,RAINFALL = x)))} -->
<!-- %  -->
<!-- %  -->
<!-- %  -->
<!-- % z <- outer(xRain, xYear, f) -->
<!-- %  -->
<!-- % persp3d(xRain, xYear, z,  col = "light blue", xlab = "Rain", ylab = "Year", zlab = "Yield") -->
<!-- % points3d(RAINFALL, YEAR, YIELD, col="red") -->
<!-- %  -->
<!-- % models <- list(fit5, fit6) -->
<!-- % ceplot(data = rainfall.data, model = models, sectionvars = "RAINFALL", threshold = 0.5) -->
<!-- %  -->
<!-- %  -->
<!-- %``` -->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ramsey2002statistical">
<p>Ramsey, Fred, and Daniel Schafer. 2002. <em>The Statistical Sleuth: A Course in Methods of Data Analysis</em>. 2nd ed. Duxbury Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="diagnostic-methods-in-more-details.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
